# Progress Log

## Learnings
(Patterns discovered during implementation)
- Use `npm create vite@latest temp-folder -- --template react-ts` to avoid non-empty directory issues, then copy files
- Vite template comes with ESLint pre-configured, just need to add eslint-config-prettier
- Add safe.directory to git config on Windows for network drives: `git config --global --add safe.directory <path>`

---

## Iteration 1 - US-001: Initialize project with Vite + React + TypeScript
- What was implemented:
  - Vite project with React 19 + TypeScript template
  - ESLint configuration with TypeScript, React hooks, React refresh plugins
  - Prettier configuration (.prettierrc)
  - Folder structure: src/components, src/hooks, src/stores, src/utils, src/types
  - Added typecheck and format npm scripts
- Files changed:
  - package.json (created, modified name/version/scripts)
  - eslint.config.js (created, modified to add prettier)
  - .prettierrc (created)
  - .gitignore (created)
  - All Vite template files
  - src/ folder structure with .gitkeep files
- Learnings for future iterations:
  - Typecheck command: `npm run typecheck`
  - Lint command: `npm run lint`
  - Dev server: `npm run dev` (runs on localhost:5173)
---

## Iteration 2 - US-002: Create app shell with layout structure
- What was implemented:
  - Flexbox-based layout with TopBar, Toolbar, Canvas, PropertiesPanel, StatusBar
  - Dark theme with CSS variables (--color-bg-primary: #1a1a1a, --color-bg-secondary: #2a2a2a)
  - Layout components in src/components/layout/
  - Collapsible properties panel with toggle button
  - Status bar with placeholder position and selection display
- Files changed:
  - src/index.css (global styles + CSS variables)
  - src/App.css (main layout)
  - src/App.tsx (component composition)
  - src/components/layout/Toolbar.tsx + .css
  - src/components/layout/TopBar.tsx + .css
  - src/components/layout/PropertiesPanel.tsx + .css
  - src/components/layout/Canvas.tsx + .css
  - src/components/layout/StatusBar.tsx + .css
  - src/components/layout/index.ts (barrel export)
- Learnings for future iterations:
  - Layout uses CSS variables for dimensions: --toolbar-width, --topbar-height, etc.
  - Components are organized in src/components/layout/
  - Use barrel exports (index.ts) for cleaner imports
---

## Iteration 3 - US-003: Implement canvas with pan and zoom
- What was implemented:
  - HTML Canvas element with 2D context, fills container and handles window resize
  - Device pixel ratio (DPR) scaling for crisp rendering on high-DPI displays
  - Mouse wheel zoom centered on cursor position (10% to 500% range)
  - Middle-mouse button drag for panning
  - Space+left-click drag for panning (alternative method)
  - Dot grid pattern that scales with zoom and moves with pan
  - Cursor changes to grab/grabbing during pan operations
- Files changed:
  - src/components/layout/Canvas.tsx (complete rewrite with pan/zoom logic)
  - src/components/layout/Canvas.css (added .canvas class styles)
- Learnings for future iterations:
  - Viewport state: { x, y, zoom } where x/y are pan offsets in canvas coords
  - Canvas uses requestAnimationFrame-compatible draw() callback
  - Use useCallback for handlers to prevent unnecessary re-renders
  - Window keydown/keyup listeners for Space key pan mode
  - Grid offset calculation: (panOffset * zoom) % gridSpacing for seamless tiling
---

## Iteration 4 - US-004: Create Zustand store for canvas state
- What was implemented:
  - Installed Zustand package for state management
  - Created TypeScript interfaces in src/types/canvas.ts for all canvas object types
  - Created Zustand store in src/stores/canvasStore.ts with:
    - State: objects (Map), selectedIds (Set), viewport
    - Actions: addObject, updateObject, deleteObject, setSelection, setViewport
  - All object types extend BaseObject with id, type, x, y, width, height, rotation, opacity
- Files changed:
  - package.json (added zustand dependency)
  - src/types/canvas.ts (created - object type definitions)
  - src/stores/canvasStore.ts (created - Zustand store)
- Learnings for future iterations:
  - Store import: `import { useCanvasStore } from '../stores/canvasStore'`
  - Types import: `import type { CanvasObject, Viewport } from '../types/canvas'`
  - Using Map and Set for objects/selectedIds for O(1) lookups
  - Object types: rectangle, ellipse, text, frame, path, image, video
  - Tool types: select, hand, rectangle, text, frame, pen
---

## Iteration 5 - US-005: Build left toolbar with tool buttons
- What was implemented:
  - Added activeTool state and setActiveTool action to Zustand store
  - Vertical toolbar with 6 tool buttons: Select (V), Hand (H), Rectangle (R), Text (T), Frame (F), Pen (P)
  - Each button has a custom SVG icon
  - Active tool highlighted with accent color (--color-accent: #0066ff)
  - Tooltips on hover showing tool name + keyboard shortcut
  - Divider line after Text tool to separate tool groups
- Files changed:
  - src/stores/canvasStore.ts (added activeTool state and setActiveTool action)
  - src/components/layout/Toolbar.tsx (added tool buttons with icons)
  - src/components/layout/Toolbar.css (added styles for buttons, active state, tooltips, divider)
- Learnings for future iterations:
  - Tool buttons use position: relative with tooltip positioned absolutely to the right
  - Tooltip appears on hover with opacity transition
  - Store state selector: `useCanvasStore((state) => state.activeTool)`
  - setActiveTool can be called with ToolType to switch tools
---

## Iteration 6 - US-006: Implement tool state and keyboard shortcuts
- What was implemented:
  - Created useKeyboardShortcuts hook in src/hooks/useKeyboardShortcuts.ts
  - Global keyboard event listener for tool switching shortcuts
  - Shortcuts: V (select), H (hand), R (rectangle), T (text), F (frame), P (pen)
  - Shortcuts disabled when typing in input fields, textareas, or contenteditable elements
  - Shortcuts also disabled when modifier keys (Ctrl/Meta/Alt) are pressed
  - Wired up hook in App.tsx to enable shortcuts globally
- Files changed:
  - src/hooks/useKeyboardShortcuts.ts (created)
  - src/App.tsx (added hook import and call)
  - PRD.md (marked task complete)
- Learnings for future iterations:
  - Check target.tagName for INPUT/TEXTAREA and target.isContentEditable to disable shortcuts
  - Use window.addEventListener for global keyboard shortcuts
  - Remember to clean up listeners in useEffect return
---
